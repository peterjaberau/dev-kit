{
  "$ref": "#/definitions/TokenBudgetConfig",
  "definitions": {
    "TokenBudgetConfig": {
      "type": "object",
      "properties": {
        "maxTokens": {
          "type": "integer",
          "exclusiveMinimum": 0,
          "description": "Maximum total tokens"
        },
        "maxPromptTokens": {
          "type": "integer",
          "exclusiveMinimum": 0,
          "description": "Max tokens for prompt"
        },
        "maxCompletionTokens": {
          "type": "integer",
          "exclusiveMinimum": 0,
          "description": "Max tokens for completion"
        },
        "reserveTokens": {
          "type": "integer",
          "minimum": 0,
          "default": 500,
          "description": "Reserve tokens for system messages"
        },
        "bufferPercentage": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "default": 0.1,
          "description": "Buffer percentage (0.1 = 10%)"
        },
        "strategy": {
          "type": "string",
          "enum": [
            "fifo",
            "importance",
            "semantic",
            "sliding_window",
            "summary"
          ],
          "default": "sliding_window"
        },
        "slidingWindowSize": {
          "type": "integer",
          "exclusiveMinimum": 0,
          "description": "Number of recent messages to keep"
        },
        "minImportanceScore": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Minimum importance to keep"
        },
        "semanticThreshold": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Semantic similarity threshold"
        },
        "enableSummarization": {
          "type": "boolean",
          "default": false,
          "description": "Enable context summarization"
        },
        "summarizationThreshold": {
          "type": "integer",
          "exclusiveMinimum": 0,
          "description": "Trigger summarization at N tokens"
        },
        "summaryModel": {
          "type": "string",
          "description": "Model ID for summarization"
        },
        "warnThreshold": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "default": 0.8,
          "description": "Warn at % of budget (0.8 = 80%)"
        }
      },
      "required": [
        "maxTokens"
      ],
      "additionalProperties": false
    }
  },
  "$schema": "http://json-schema.org/draft-07/schema#"
}