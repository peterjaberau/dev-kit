{
  "$ref": "#/definitions/CreateSpaceRequest",
  "definitions": {
    "CreateSpaceRequest": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1,
          "maxLength": 255,
          "description": "Space display name"
        },
        "slug": {
          "type": "string",
          "pattern": "^[a-z0-9-]+$",
          "minLength": 1,
          "maxLength": 100,
          "description": "URL-friendly identifier"
        },
        "ownerId": {
          "type": "string",
          "description": "Owner user/org ID"
        },
        "runtime": {
          "type": "object",
          "properties": {
            "isolation": {
              "type": "string",
              "enum": [
                "shared_schema",
                "isolated_schema",
                "isolated_db"
              ],
              "description": "Data isolation strategy"
            },
            "quotas": {
              "type": "object",
              "properties": {
                "maxUsers": {
                  "type": "integer",
                  "exclusiveMinimum": 0,
                  "description": "Maximum number of users"
                },
                "maxStorage": {
                  "type": "integer",
                  "exclusiveMinimum": 0,
                  "description": "Maximum storage in bytes"
                },
                "apiRateLimit": {
                  "type": "integer",
                  "exclusiveMinimum": 0,
                  "description": "API requests per minute"
                }
              },
              "additionalProperties": false,
              "description": "Resource quotas"
            }
          },
          "required": [
            "isolation"
          ],
          "additionalProperties": false,
          "description": "Runtime instance configuration"
        },
        "bom": {
          "type": "object",
          "properties": {
            "tenantId": {
              "type": "string",
              "description": "Target Tenant ID"
            },
            "dependencies": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "id": {
                    "type": "string",
                    "description": "Plugin ID (e.g. \"com.example.crm\")"
                  },
                  "version": {
                    "type": "string",
                    "default": "latest",
                    "description": "SemVer range or \"latest\""
                  },
                  "configuration": {
                    "type": "object",
                    "additionalProperties": {},
                    "description": "Configuration overrides"
                  },
                  "features": {
                    "type": "object",
                    "additionalProperties": {
                      "type": "boolean"
                    },
                    "description": "Feature toggles"
                  }
                },
                "required": [
                  "id"
                ],
                "additionalProperties": false
              },
              "description": "Installed packages"
            },
            "environment": {
              "type": "object",
              "additionalProperties": {
                "type": "string"
              }
            },
            "resolutionStrategy": {
              "type": "string",
              "enum": [
                "strict",
                "override",
                "merge"
              ],
              "default": "override",
              "description": "Conflict resolution strategy (strict=fail, override=last-wins, merge=deep-merge)"
            }
          },
          "required": [
            "tenantId",
            "dependencies"
          ],
          "additionalProperties": false,
          "description": "Initial Bill of Materials"
        },
        "subscription": {
          "type": "object",
          "properties": {
            "planId": {
              "type": "string",
              "description": "Reference to Plan Code"
            },
            "status": {
              "type": "string",
              "enum": [
                "active",
                "past_due",
                "canceled",
                "trialing",
                "incomplete"
              ]
            },
            "currentPeriodEnd": {
              "type": "string",
              "format": "date-time"
            },
            "stripeCustomerId": {
              "type": "string"
            },
            "stripeSubscriptionId": {
              "type": "string"
            },
            "addons": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "pluginId": {
                    "type": "string",
                    "description": "Marketplace Plugin ID (NPM package name)"
                  },
                  "quantity": {
                    "type": "number",
                    "default": 1
                  },
                  "status": {
                    "type": "string",
                    "enum": [
                      "active",
                      "past_due",
                      "canceled",
                      "trialing",
                      "incomplete"
                    ],
                    "default": "active"
                  }
                },
                "required": [
                  "pluginId"
                ],
                "additionalProperties": false
              }
            },
            "usage": {
              "type": "object",
              "additionalProperties": {
                "type": "number"
              }
            }
          },
          "required": [
            "planId",
            "status"
          ],
          "additionalProperties": false
        },
        "deployment": {
          "type": "object",
          "properties": {
            "provider": {
              "type": "string",
              "enum": [
                "vercel",
                "docker",
                "kubernetes"
              ]
            },
            "region": {
              "type": "string"
            },
            "url": {
              "type": "string",
              "format": "uri",
              "description": "Public Access URL"
            },
            "env": {
              "type": "object",
              "additionalProperties": {
                "type": "string"
              },
              "description": "Runtime Environment Variables"
            }
          },
          "required": [
            "provider"
          ],
          "additionalProperties": false
        }
      },
      "required": [
        "name",
        "slug",
        "ownerId"
      ],
      "additionalProperties": false
    }
  },
  "$schema": "http://json-schema.org/draft-07/schema#"
}