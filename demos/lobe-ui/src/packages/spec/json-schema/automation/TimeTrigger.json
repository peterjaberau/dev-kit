{
  "$ref": "#/definitions/TimeTrigger",
  "definitions": {
    "TimeTrigger": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier"
        },
        "timeLength": {
          "type": "integer",
          "description": "Duration amount (e.g. 1, 30)"
        },
        "timeUnit": {
          "type": "string",
          "enum": [
            "minutes",
            "hours",
            "days"
          ],
          "description": "Unit of time"
        },
        "offsetDirection": {
          "type": "string",
          "enum": [
            "before",
            "after"
          ],
          "description": "Before or After the reference date"
        },
        "offsetFrom": {
          "type": "string",
          "enum": [
            "trigger_date",
            "date_field"
          ],
          "description": "Basis for calculation"
        },
        "dateField": {
          "type": "string",
          "description": "Date field to calculate from (required if offsetFrom is date_field)"
        },
        "actions": {
          "type": "array",
          "items": {
            "anyOf": [
              {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Action name"
                  },
                  "type": {
                    "type": "string",
                    "const": "field_update"
                  },
                  "field": {
                    "type": "string",
                    "description": "Field to update"
                  },
                  "value": {
                    "description": "Value or Formula to set"
                  }
                },
                "required": [
                  "name",
                  "type",
                  "field"
                ],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Action name"
                  },
                  "type": {
                    "type": "string",
                    "const": "email_alert"
                  },
                  "template": {
                    "type": "string",
                    "description": "Email template ID/DevName"
                  },
                  "recipients": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "List of recipient emails or user IDs"
                  }
                },
                "required": [
                  "name",
                  "type",
                  "template",
                  "recipients"
                ],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Action name"
                  },
                  "type": {
                    "type": "string",
                    "const": "http_call"
                  },
                  "url": {
                    "type": "string",
                    "description": "Target URL"
                  },
                  "method": {
                    "type": "string",
                    "enum": [
                      "GET",
                      "POST",
                      "PUT",
                      "DELETE",
                      "PATCH"
                    ],
                    "default": "POST",
                    "description": "HTTP Method"
                  },
                  "headers": {
                    "type": "object",
                    "additionalProperties": {
                      "type": "string"
                    },
                    "description": "HTTP Headers"
                  },
                  "body": {
                    "type": "string",
                    "description": "Request body (JSON or text)"
                  }
                },
                "required": [
                  "name",
                  "type",
                  "url"
                ],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Action name"
                  },
                  "type": {
                    "type": "string",
                    "const": "connector_action"
                  },
                  "connectorId": {
                    "type": "string",
                    "description": "Target Connector ID (e.g. slack, twilio)"
                  },
                  "actionId": {
                    "type": "string",
                    "description": "Target Action ID (e.g. send_message)"
                  },
                  "input": {
                    "type": "object",
                    "additionalProperties": {},
                    "description": "Input parameters matching the action schema"
                  }
                },
                "required": [
                  "name",
                  "type",
                  "connectorId",
                  "actionId",
                  "input"
                ],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Action name"
                  },
                  "type": {
                    "type": "string",
                    "const": "task_creation"
                  },
                  "taskObject": {
                    "type": "string",
                    "description": "Task object name (e.g., \"task\", \"project_task\")"
                  },
                  "subject": {
                    "type": "string",
                    "description": "Task subject/title"
                  },
                  "description": {
                    "type": "string",
                    "description": "Task description"
                  },
                  "assignedTo": {
                    "type": "string",
                    "description": "User ID or field reference for assignee"
                  },
                  "dueDate": {
                    "type": "string",
                    "description": "Due date (ISO string or formula)"
                  },
                  "priority": {
                    "type": "string",
                    "description": "Task priority"
                  },
                  "relatedTo": {
                    "type": "string",
                    "description": "Related record ID or field reference"
                  },
                  "additionalFields": {
                    "type": "object",
                    "additionalProperties": {},
                    "description": "Additional custom fields"
                  }
                },
                "required": [
                  "name",
                  "type",
                  "taskObject",
                  "subject"
                ],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Action name"
                  },
                  "type": {
                    "type": "string",
                    "const": "push_notification"
                  },
                  "title": {
                    "type": "string",
                    "description": "Notification title"
                  },
                  "body": {
                    "type": "string",
                    "description": "Notification body text"
                  },
                  "recipients": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "User IDs or device tokens"
                  },
                  "data": {
                    "type": "object",
                    "additionalProperties": {},
                    "description": "Additional data payload"
                  },
                  "badge": {
                    "type": "number",
                    "description": "Badge count (iOS)"
                  },
                  "sound": {
                    "type": "string",
                    "description": "Notification sound"
                  },
                  "clickAction": {
                    "type": "string",
                    "description": "Action/URL when notification is clicked"
                  }
                },
                "required": [
                  "name",
                  "type",
                  "title",
                  "body",
                  "recipients"
                ],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Action name"
                  },
                  "type": {
                    "type": "string",
                    "const": "custom_script"
                  },
                  "language": {
                    "type": "string",
                    "enum": [
                      "javascript",
                      "typescript",
                      "python"
                    ],
                    "default": "javascript",
                    "description": "Script language"
                  },
                  "code": {
                    "type": "string",
                    "description": "Script code to execute"
                  },
                  "timeout": {
                    "type": "number",
                    "default": 30000,
                    "description": "Execution timeout in milliseconds"
                  },
                  "context": {
                    "type": "object",
                    "additionalProperties": {},
                    "description": "Additional context variables"
                  }
                },
                "required": [
                  "name",
                  "type",
                  "code"
                ],
                "additionalProperties": false
              }
            ]
          },
          "description": "Actions to execute at the scheduled time"
        }
      },
      "required": [
        "timeLength",
        "timeUnit",
        "offsetDirection",
        "offsetFrom",
        "actions"
      ],
      "additionalProperties": false
    }
  },
  "$schema": "http://json-schema.org/draft-07/schema#"
}