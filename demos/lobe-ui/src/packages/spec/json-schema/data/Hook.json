{
  "$ref": "#/definitions/Hook",
  "definitions": {
    "Hook": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "pattern": "^[a-z_][a-z0-9_]*$",
          "description": "Hook unique name (snake_case)"
        },
        "label": {
          "type": "string",
          "description": "Description of what this hook does"
        },
        "object": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          ],
          "description": "Target object(s)"
        },
        "events": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "beforeFind",
              "afterFind",
              "beforeFindOne",
              "afterFindOne",
              "beforeCount",
              "afterCount",
              "beforeAggregate",
              "afterAggregate",
              "beforeInsert",
              "afterInsert",
              "beforeUpdate",
              "afterUpdate",
              "beforeDelete",
              "afterDelete",
              "beforeUpdateMany",
              "afterUpdateMany",
              "beforeDeleteMany",
              "afterDeleteMany"
            ]
          },
          "description": "Lifecycle events"
        },
        "handler": {
          "anyOf": [
            {
              "type": "string"
            },
            {}
          ],
          "description": "Function handler name or direct function"
        },
        "priority": {
          "type": "number",
          "default": 100,
          "description": "Execution priority"
        },
        "async": {
          "type": "boolean",
          "default": false,
          "description": "Run specifically as fire-and-forget"
        },
        "onError": {
          "type": "string",
          "enum": [
            "abort",
            "log"
          ],
          "default": "abort",
          "description": "Error handling strategy"
        }
      },
      "required": [
        "name",
        "object",
        "events"
      ],
      "additionalProperties": false
    }
  },
  "$schema": "http://json-schema.org/draft-07/schema#"
}