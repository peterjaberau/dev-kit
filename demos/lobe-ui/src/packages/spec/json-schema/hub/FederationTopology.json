{
  "$ref": "#/definitions/FederationTopology",
  "definitions": {
    "FederationTopology": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string"
        },
        "regions": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": {
                "type": "string",
                "pattern": "^[a-z]{2}-[a-z]+-\\d+$",
                "description": "Region identifier"
              },
              "name": {
                "type": "string",
                "description": "Human-readable region name"
              },
              "location": {
                "type": "object",
                "properties": {
                  "continent": {
                    "type": "string",
                    "enum": [
                      "NA",
                      "SA",
                      "EU",
                      "AF",
                      "AS",
                      "OC",
                      "AN"
                    ]
                  },
                  "country": {
                    "type": "string",
                    "pattern": "^[A-Z]{2}$",
                    "description": "ISO 3166-1 alpha-2 country code"
                  },
                  "city": {
                    "type": "string"
                  },
                  "latitude": {
                    "type": "number",
                    "minimum": -90,
                    "maximum": 90
                  },
                  "longitude": {
                    "type": "number",
                    "minimum": -180,
                    "maximum": 180
                  }
                },
                "required": [
                  "continent",
                  "country"
                ],
                "additionalProperties": false
              },
              "provider": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "enum": [
                      "aws",
                      "azure",
                      "gcp",
                      "cloudflare",
                      "vercel",
                      "self-hosted"
                    ]
                  },
                  "region": {
                    "type": "string",
                    "description": "Provider-specific region identifier"
                  }
                },
                "required": [
                  "name",
                  "region"
                ],
                "additionalProperties": false
              },
              "capabilities": {
                "type": "object",
                "properties": {
                  "databases": {
                    "type": "array",
                    "items": {
                      "type": "string",
                      "enum": [
                        "postgres",
                        "mysql",
                        "mongodb",
                        "redis"
                      ]
                    },
                    "default": []
                  },
                  "storage": {
                    "type": "array",
                    "items": {
                      "type": "string",
                      "enum": [
                        "s3",
                        "azure-blob",
                        "gcs"
                      ]
                    },
                    "default": []
                  },
                  "compute": {
                    "type": "array",
                    "items": {
                      "type": "string",
                      "enum": [
                        "containers",
                        "serverless",
                        "vm"
                      ]
                    },
                    "default": []
                  },
                  "cdn": {
                    "type": "boolean",
                    "default": false
                  }
                },
                "additionalProperties": false
              },
              "compliance": {
                "type": "array",
                "items": {
                  "type": "string",
                  "enum": [
                    "gdpr",
                    "hipaa",
                    "soc2",
                    "iso27001",
                    "pci-dss"
                  ]
                },
                "default": []
              },
              "status": {
                "type": "string",
                "enum": [
                  "active",
                  "read-only",
                  "maintenance",
                  "deprecated"
                ],
                "default": "active"
              },
              "limits": {
                "type": "object",
                "properties": {
                  "maxSpaces": {
                    "type": "integer",
                    "exclusiveMinimum": 0
                  },
                  "maxTenants": {
                    "type": "integer",
                    "exclusiveMinimum": 0
                  },
                  "maxStorage": {
                    "type": "integer",
                    "exclusiveMinimum": 0,
                    "description": "Bytes"
                  }
                },
                "additionalProperties": false
              }
            },
            "required": [
              "id",
              "name",
              "location"
            ],
            "additionalProperties": false
          }
        },
        "hubs": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": {
                "type": "string",
                "format": "uuid"
              },
              "regionId": {
                "type": "string"
              },
              "role": {
                "type": "string",
                "enum": [
                  "primary",
                  "secondary",
                  "edge"
                ]
              },
              "endpoints": {
                "type": "object",
                "properties": {
                  "api": {
                    "type": "string",
                    "format": "uri",
                    "description": "Public API endpoint"
                  },
                  "admin": {
                    "type": "string",
                    "format": "uri",
                    "description": "Admin console"
                  },
                  "grpc": {
                    "type": "string",
                    "description": "gRPC endpoint for inter-hub communication"
                  }
                },
                "required": [
                  "api"
                ],
                "additionalProperties": false
              },
              "replication": {
                "type": "object",
                "properties": {
                  "primaryHubId": {
                    "type": "string",
                    "format": "uuid"
                  },
                  "lagTolerance": {
                    "type": "integer",
                    "exclusiveMinimum": 0,
                    "default": 5
                  },
                  "mode": {
                    "type": "string",
                    "enum": [
                      "sync",
                      "async",
                      "semi-sync"
                    ],
                    "default": "async"
                  }
                },
                "additionalProperties": false
              },
              "health": {
                "type": "object",
                "properties": {
                  "status": {
                    "type": "string",
                    "enum": [
                      "healthy",
                      "degraded",
                      "unhealthy"
                    ]
                  },
                  "lastCheck": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "uptime": {
                    "type": "number",
                    "description": "Seconds"
                  }
                },
                "required": [
                  "status",
                  "lastCheck",
                  "uptime"
                ],
                "additionalProperties": false
              },
              "version": {
                "type": "string"
              },
              "createdAt": {
                "type": "string",
                "format": "date-time"
              },
              "updatedAt": {
                "type": "string",
                "format": "date-time"
              }
            },
            "required": [
              "id",
              "regionId",
              "role",
              "endpoints",
              "version",
              "createdAt",
              "updatedAt"
            ],
            "additionalProperties": false
          }
        },
        "routing": {
          "type": "object",
          "properties": {
            "strategy": {
              "type": "string",
              "enum": [
                "geo-proximity",
                "data-residency",
                "least-loaded",
                "custom"
              ],
              "default": "geo-proximity"
            },
            "failover": {
              "type": "object",
              "properties": {
                "enabled": {
                  "type": "boolean",
                  "default": true
                },
                "maxRetries": {
                  "type": "integer",
                  "minimum": 0,
                  "default": 3
                },
                "timeout": {
                  "type": "integer",
                  "exclusiveMinimum": 0,
                  "default": 5000,
                  "description": "Milliseconds"
                }
              },
              "additionalProperties": false
            }
          },
          "required": [
            "failover"
          ],
          "additionalProperties": false
        },
        "synchronization": {
          "type": "object",
          "properties": {
            "scope": {
              "type": "object",
              "properties": {
                "plugins": {
                  "type": "boolean",
                  "default": true
                },
                "tenants": {
                  "type": "boolean",
                  "default": true
                },
                "spaces": {
                  "type": "boolean",
                  "default": false
                },
                "licenses": {
                  "type": "boolean",
                  "default": true
                }
              },
              "additionalProperties": false
            },
            "frequency": {
              "type": "string",
              "enum": [
                "realtime",
                "hourly",
                "daily"
              ],
              "default": "realtime"
            },
            "conflictResolution": {
              "type": "string",
              "enum": [
                "last-write-wins",
                "primary-wins",
                "manual"
              ],
              "default": "last-write-wins"
            }
          },
          "required": [
            "scope"
          ],
          "additionalProperties": false
        }
      },
      "required": [
        "id",
        "name",
        "regions",
        "hubs",
        "routing",
        "synchronization"
      ],
      "additionalProperties": false
    }
  },
  "$schema": "http://json-schema.org/draft-07/schema#"
}