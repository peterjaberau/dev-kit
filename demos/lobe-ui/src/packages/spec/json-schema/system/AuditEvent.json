{
  "$ref": "#/definitions/AuditEvent",
  "definitions": {
    "AuditEvent": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "description": "Audit event ID"
        },
        "eventType": {
          "type": "string",
          "enum": [
            "data.create",
            "data.read",
            "data.update",
            "data.delete",
            "data.export",
            "data.import",
            "data.bulk_update",
            "data.bulk_delete",
            "auth.login",
            "auth.login_failed",
            "auth.logout",
            "auth.session_created",
            "auth.session_expired",
            "auth.password_reset",
            "auth.password_changed",
            "auth.email_verified",
            "auth.mfa_enabled",
            "auth.mfa_disabled",
            "auth.account_locked",
            "auth.account_unlocked",
            "authz.permission_granted",
            "authz.permission_revoked",
            "authz.role_assigned",
            "authz.role_removed",
            "authz.role_created",
            "authz.role_updated",
            "authz.role_deleted",
            "authz.policy_created",
            "authz.policy_updated",
            "authz.policy_deleted",
            "system.config_changed",
            "system.plugin_installed",
            "system.plugin_uninstalled",
            "system.backup_created",
            "system.backup_restored",
            "system.integration_added",
            "system.integration_removed",
            "security.access_denied",
            "security.suspicious_activity",
            "security.data_breach",
            "security.api_key_created",
            "security.api_key_revoked"
          ],
          "description": "Event type"
        },
        "severity": {
          "type": "string",
          "enum": [
            "debug",
            "info",
            "notice",
            "warning",
            "error",
            "critical",
            "alert",
            "emergency"
          ],
          "default": "info",
          "description": "Event severity"
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "Event timestamp"
        },
        "actor": {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "user",
                "system",
                "service",
                "api_client",
                "integration"
              ],
              "description": "Actor type"
            },
            "id": {
              "type": "string",
              "description": "Actor identifier"
            },
            "name": {
              "type": "string",
              "description": "Actor display name"
            },
            "email": {
              "type": "string",
              "format": "email",
              "description": "Actor email address"
            },
            "ipAddress": {
              "type": "string",
              "description": "Actor IP address"
            },
            "userAgent": {
              "type": "string",
              "description": "User agent string"
            }
          },
          "required": [
            "type",
            "id"
          ],
          "additionalProperties": false,
          "description": "Event actor"
        },
        "target": {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "description": "Target type"
            },
            "id": {
              "type": "string",
              "description": "Target identifier"
            },
            "name": {
              "type": "string",
              "description": "Target display name"
            },
            "metadata": {
              "type": "object",
              "additionalProperties": {},
              "description": "Target metadata"
            }
          },
          "required": [
            "type",
            "id"
          ],
          "additionalProperties": false,
          "description": "Event target"
        },
        "description": {
          "type": "string",
          "description": "Event description"
        },
        "changes": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "field": {
                "type": "string",
                "description": "Changed field name"
              },
              "oldValue": {
                "description": "Previous value"
              },
              "newValue": {
                "description": "New value"
              }
            },
            "required": [
              "field"
            ],
            "additionalProperties": false
          },
          "description": "List of changes"
        },
        "result": {
          "type": "string",
          "enum": [
            "success",
            "failure",
            "partial"
          ],
          "default": "success",
          "description": "Action result"
        },
        "errorMessage": {
          "type": "string",
          "description": "Error message"
        },
        "tenantId": {
          "type": "string",
          "description": "Tenant identifier"
        },
        "requestId": {
          "type": "string",
          "description": "Request ID for tracing"
        },
        "metadata": {
          "type": "object",
          "additionalProperties": {},
          "description": "Additional metadata"
        },
        "location": {
          "type": "object",
          "properties": {
            "country": {
              "type": "string"
            },
            "region": {
              "type": "string"
            },
            "city": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "description": "Geographic location"
        }
      },
      "required": [
        "id",
        "eventType",
        "timestamp",
        "actor",
        "description"
      ],
      "additionalProperties": false
    }
  },
  "$schema": "http://json-schema.org/draft-07/schema#"
}