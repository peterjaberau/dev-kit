{
  "$ref": "#/definitions/MetricDefinition",
  "definitions": {
    "MetricDefinition": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "pattern": "^[a-z_][a-z0-9_]*$",
          "description": "Metric name (snake_case)"
        },
        "label": {
          "type": "string",
          "description": "Display label"
        },
        "type": {
          "type": "string",
          "enum": [
            "counter",
            "gauge",
            "histogram",
            "summary"
          ],
          "description": "Metric type"
        },
        "unit": {
          "type": "string",
          "enum": [
            "nanoseconds",
            "microseconds",
            "milliseconds",
            "seconds",
            "minutes",
            "hours",
            "days",
            "bytes",
            "kilobytes",
            "megabytes",
            "gigabytes",
            "terabytes",
            "requests_per_second",
            "events_per_second",
            "bytes_per_second",
            "percent",
            "ratio",
            "count",
            "operations",
            "custom"
          ],
          "description": "Metric unit"
        },
        "description": {
          "type": "string",
          "description": "Metric description"
        },
        "labelNames": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "default": [],
          "description": "Label names"
        },
        "histogram": {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "linear",
                "exponential",
                "explicit"
              ],
              "description": "Bucket type"
            },
            "linear": {
              "type": "object",
              "properties": {
                "start": {
                  "type": "number",
                  "description": "Start value"
                },
                "width": {
                  "type": "number",
                  "exclusiveMinimum": 0,
                  "description": "Bucket width"
                },
                "count": {
                  "type": "integer",
                  "exclusiveMinimum": 0,
                  "description": "Number of buckets"
                }
              },
              "required": [
                "start",
                "width",
                "count"
              ],
              "additionalProperties": false
            },
            "exponential": {
              "type": "object",
              "properties": {
                "start": {
                  "type": "number",
                  "exclusiveMinimum": 0,
                  "description": "Start value"
                },
                "factor": {
                  "type": "number",
                  "exclusiveMinimum": 0,
                  "description": "Growth factor"
                },
                "count": {
                  "type": "integer",
                  "exclusiveMinimum": 0,
                  "description": "Number of buckets"
                }
              },
              "required": [
                "start",
                "factor",
                "count"
              ],
              "additionalProperties": false
            },
            "explicit": {
              "type": "object",
              "properties": {
                "boundaries": {
                  "type": "array",
                  "items": {
                    "type": "number"
                  },
                  "description": "Bucket boundaries"
                }
              },
              "required": [
                "boundaries"
              ],
              "additionalProperties": false
            }
          },
          "required": [
            "type"
          ],
          "additionalProperties": false,
          "description": "Histogram bucket configuration"
        },
        "summary": {
          "type": "object",
          "properties": {
            "quantiles": {
              "type": "array",
              "items": {
                "type": "number",
                "minimum": 0,
                "maximum": 1
              },
              "default": [
                0.5,
                0.9,
                0.99
              ]
            },
            "maxAge": {
              "type": "integer",
              "exclusiveMinimum": 0,
              "default": 600
            },
            "ageBuckets": {
              "type": "integer",
              "exclusiveMinimum": 0,
              "default": 5
            }
          },
          "additionalProperties": false
        },
        "enabled": {
          "type": "boolean",
          "default": true
        }
      },
      "required": [
        "name",
        "type"
      ],
      "additionalProperties": false,
      "description": "Metric definition"
    }
  },
  "$schema": "http://json-schema.org/draft-07/schema#"
}